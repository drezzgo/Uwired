<section class="comment-section">
  <h2>Comentarios</h2>

  <form class="comment-form" id="commentForm">
    <div class="form-group">
      <label for="nombre">Nombre:</label>
      <input type="text" id="nombre" name="nombre" placeholder="Tu nombre" required>
    </div>
    
    <div class="form-group">
      <label for="email">Correo electrónico:</label>
      <input type="email" id="email" name="email" placeholder="Tu correo electrónico" required>
    </div>
    
    <div class="form-group">
      <label for="mensaje">Mensaje:</label>
      <textarea id="mensaje" name="mensaje" rows="4" placeholder="Escribe tu comentario" required maxlength="200"></textarea>
    </div>

    <button type="submit" class="btn">Enviar</button>
  </form>

  <ul class="comment-list" id="commentList">
  </ul>
</section>

<style>
  .comment-section {
    margin-top: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #f9f9f9;
  }

  .comment-form {
    margin-bottom: 20px;
  }

  .form-group {
    margin-bottom: 10px;
  }

  .form-group label {
    display: block;
    margin-bottom: 5px;
  }

  .form-group input,
  .form-group textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }

  .btn {
    background-color: #007bff;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  .btn:hover {
    background-color: #0056b3;
  }

  .comment-item {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background-color: #f9f9f9;
  }
</style>

<script>
  function cargarComentarios() {
    const comentarios = [
      { nombre: "", email: "", mensaje: "" }
    ];

    comentarios.forEach(comentario => {
      agregarComentario(comentario.nombre, comentario.email, comentario.mensaje);
    });
  }
  
  function agregarComentario(nombre : string, email : string, mensaje : string) {
    const commentList = document.getElementById('commentList');
    if (commentList) {
        const listItem = document.createElement('li');
        listItem.classList.add('comment-item');
        listItem.innerHTML = `
            <div class="comment-author">${nombre} (${email})</div>
            <div class="comment-content">${mensaje}</div>
        `;
        commentList.appendChild(listItem);
    } else {
        console.error("commentList es nulo");
    }
}
  
  window.onload = cargarComentarios;

  const commentForm = document.getElementById('commentForm');
  if (commentForm) {
    commentForm.addEventListener('submit', function(event) {
      event.preventDefault(); 

      const nombreInput = document.getElementById('nombre') as HTMLInputElement;
      const emailInput = document.getElementById('email') as HTMLInputElement;
      const mensajeInput = document.getElementById('mensaje') as HTMLInputElement;

      if (nombreInput && emailInput && mensajeInput) {
        const nombre = nombreInput.value;
        const email = emailInput.value;
        const mensaje = mensajeInput.value;

        if (!validarCorreo(email)) {
          alert("Por favor, introduce un correo electrónico válido.");
          return;
        }

        if (mensaje.length > 200) {
          alert("El mensaje no puede exceder los 200 caracteres.");
          return;
        }

        agregarComentario(nombre, email, mensaje);

        nombreInput.value = '';
        emailInput.value = '';
        mensajeInput.value = '';
      } else {
        console.error("Al menos uno de los elementos de input es nulo");
      }
    });
  } else {
    console.error("No se encontró el formulario de comentarios");
  }

  function validarCorreo(correo : string) {
    const expresion = /\S+@\S+\.\S+/;
    return expresion.test(correo);
  }
</script>
